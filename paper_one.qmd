---
title: "Toronto Major Crime"
author: "Alexander Guarasci"
date: "`r format(Sys.Date(), '%B %d, %Y')`" # This will add the current date
date-format: long
bibliography: references.bib
execute:
  echo: false
format: pdf
fig-pos: "H"
abstract: |

 This paper investigates major crime trends in Toronto from 2014-2024, using data sourced from OpenDataToronto. Of particular interest, the data shows that assault, motor vehicle theft and the total number of major crimes have been steadiily on the rise throughout the 10 years this data has been recorded. This research is significant as it provides insights into crime in Canada's largest city; It aims to help build an understanding of the nature of Toronto's crime scene.
---

# 1 Introduction

# 2 Data

The data used in this paper was gathered from OpenDataToronto [@opendatatoronto]. OpenDataToronto is a publicly funded data-gathering service that collects and publishes data about Toronto and the GTA. The specific dataset used in this paper is called “Major Crime Indicators”, and was published by Toronto Police Services. The data includes "all Major Crime Indicator offences reported by date" In order to perform the analysis, the programming language for data analysis, visualization and statistical investigation Python was used [@Python], along with the Python packages Matplotlib.pyplot [@Matplot], Seaborn [@Seaborn], Pandas [@Pandas], Requests[@requests], Pytest[@pytest], IO[@io], and Random[@random].

# 2.1 The Dataset

As mentioned, the dataset used in this paper is the "Major Crime Indicators" from OpenDataToronto. The dataset includes around 400,000 samples each with 26 observations, including the report date, the occurrence date, the neighbourhood that the crime took place in, where the crime took place (whether it was in an apartment, a restaurant, outside, etc), and many more. No other datasets were considered because no other department has access to this information. There are a few interesting things to note with the dataset. The first is that sexual assaults were not included, it is not explained why this is done but it is an important thing to note when looking through the paper. Secondly, there are instances in which a crime has several instances of data if it was the case that someone broke into a house (B&E) and proceeded to assault the residences, this may be recorded as two separate instances (ie. one for B&E and one for assault). Lastly, the dataset does not include occurrences that police have investigated and determined did not occur, nor was it attempted. This may result in inaccurate reporting, and police methods are often wrong so it is highly likely that the data is not flawless and may leave some crimes out.

With respect to the cleaning of the dataset, I removed quite a few redundant columns (ie. there were 7 columns that had data on the occurrence date which seemed unnecessary). Also, I eliminated police-specific data points, like the ID of the crime which we have no use for in this analysis. 

# 2.2 Variables of Interest

The cleaned data includes four variables. The date of the offence, the type of offence, the neighbourhood the offence took place in and the location type (ie. apartment, etc). The date of the offence needs no explanation, but it is important to note that although this data started being recorded in 2014, some people reported crimes back as far as 1966, because this skews certain data points, all the analysis is done for crimes after 2014 (I left the older data in the cleaned dataset so people can examine it if they choose). The type of offence is also relatively straight forward, one aspect of it that is important is they do distinguish between different types of crimes. For example, assault and assault with a weapon are two different types of offences, and so is B&E and B&E with intent. The neighbourhood aspect is rather unambiguous, these are the 158 social planning neighbourhoods that Toronto is broken up into, and these are for almost used for all relevant datasets. And the location type is also straightforward. 

# 2.3 Measurement

The measurement of this data is not particularly complex and does not have too much room for error. The event takes place and then is reported to the police, the police categorize each instance, using the reported date, time, location, neighbourhood, and offence and this information is added to the dataset.  The reporting method is somewhat flawed, it all depends on what the victim claims happened, it is certain that some details (like the hour the incident took place) are not completely accurate, as a lot of these crimes were reported quite long after the fact.  There is also the police categorization of these crimes, for example, what distinguishes assault from assault with a weapon, and what is considered a weapon? These can create uncertainty and measurement errors in the data, but ultimately, because of how broad these categorizations are and their legal definitions, it should not detract from the following analysis. 

# 3 Data Visualization and Analysis

Our analysis explores the trends in major crime indicators in the GTA from 2014 to 2024.

The first graph shows the overall breakdown of the top 20 types of major crimes committed over the study.

```{python}


import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# Load the data
file_path = "outputs/cleaned_data.csv"
data = pd.read_csv(file_path)

# Ensure the 'date' column is in datetime format
data['date'] = pd.to_datetime(data['date'])
data = data[data['date'].dt.year >= 2014]  # Filter out data before 1966

# Set a general style for the plots
sns.set(style="whitegrid")

# Breakdown of Offence Types
plt.figure(figsize=(14, 8))
offence_counts = data['offence'].value_counts().head(20)  # Limit to top 20 offences for clarity
sns.barplot(x=offence_counts.values, y=offence_counts.index, palette="Blues_d")
plt.title('Figure 1: Top 20 Offence Types (2014-2024)')
plt.xlabel('Count')
plt.ylabel('Offence')
plt.grid(True)
plt.tight_layout()
plt.show()
```


@
```{python}


import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns






# Load the data
file_path = "outputs/cleaned_data.csv"
data = pd.read_csv(file_path)


# Ensure the 'date' column is in datetime format
data['date'] = pd.to_datetime(data['date'])
data = data[data['date'].dt.year >= 2014]  # Filter out data before 1966


# Set a general style for the plots
sns.set(style="whitegrid")

# 4. Trends of Crimes by Year
data['year'] = data['date'].dt.year
plt.figure(figsize=(14, 8))
yearly_offence_trends = data.groupby(['year', 'offence']).size().unstack().fillna(0)
# Plot the top 5 offences over time
top_offences = data['offence'].value_counts().index[:5]
yearly_offence_trends[top_offences].plot(kind='line', marker='o', figsize=(14, 8), linewidth=2.5)

plt.title('Crime Trends by Year (Top 5 Offences)')
plt.xlabel('Year')
plt.ylabel('Number of Crimes')
plt.grid(True)
plt.legend(title='Offence Type')
plt.tight_layout()
plt.savefig('improved_crime_trends_by_year.png')
plt.show()

```

```{python}

import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns






# Load the data
file_path = "outputs/cleaned_data.csv"
data = pd.read_csv(file_path)


# Ensure the 'date' column is in datetime format
data['date'] = pd.to_datetime(data['date'])
data = data[data['date'].dt.year >= 2014]  # Filter out data before 1966
data['year'] = data['date'].dt.year
data['month'] = data['date'].dt.month
data['day_of_week'] = data['date'].dt.day_name()


# Set a general style for the plots
sns.set(style="whitegrid")

### 1. Heatmap of Crime Frequency by Month and Year
plt.figure(figsize=(12, 8))
crime_by_month_year = data.groupby(['year', 'month']).size().unstack(fill_value=0)
sns.heatmap(crime_by_month_year, cmap="Blues", annot=False, linewidths=0.5)
plt.title('Crime Frequency Heatmap by Month and Year')
plt.xlabel('Month')
plt.ylabel('Year')
plt.tight_layout()
plt.savefig('crime_heatmap_month_year.png')
plt.show()

```